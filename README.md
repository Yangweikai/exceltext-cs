# Excel翻译工具 - 清新版

一个基于Web的Excel文件翻译工具，支持中英文翻译，具有清新美观的界面和实时进度显示。

## 功能特点

- 🌐 **智能翻译**: 使用百度翻译API进行中英文翻译
- 📊 **批量处理**: 支持Excel文件批量翻译
- 🎨 **清新界面**: 现代化、美观的用户界面
- 📈 **实时进度**: 实时显示翻译进度和状态
- 🔧 **灵活配置**: 支持选择工作表、列、行范围
- 💾 **自动保存**: 自动调整列宽行高，保存翻译结果
- ⚡ **错误处理**: 完善的错误处理和重试机制

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 获取百度翻译API

1. 访问 [百度翻译开放平台](https://api.fanyi.baidu.com/)
2. 注册账号并创建应用
3. 获取App ID和App Key
4. 将您的IP地址添加到白名单

### 3. 运行应用

```bash
python app.py
```

应用将在 `http://localhost:5000` 启动

## 使用说明

### 1. 上传文件
- 点击文件上传区域选择Excel文件(.xlsx格式)
- 系统会自动读取文件信息

### 2. 配置API
- 输入您的百度翻译App ID和App Key
- 系统会自动测试API连接

### 3. 设置翻译参数
- **起始行**: 开始翻译的行号（默认为2，跳过标题行）
- **结束行**: 结束翻译的行号（留空表示到末尾）
- **工作表**: 选择要翻译的工作表（支持多选）
- **列**: 选择要翻译的列（支持多选）

### 4. 开始翻译
- 点击"开始翻译"按钮
- 系统会显示实时进度和状态信息
- 翻译完成后可以下载结果文件

## 翻译规则

- **格式**: 翻译后的内容格式为"英文\n中文"
- **重复检测**: 自动跳过已翻译的内容
- **顺序调整**: 自动调整中英文顺序，确保英文在上方
- **样式优化**: 自动调整列宽和行高以适应内容

## 文件结构

```
exceltext-cs/
├── app.py                 # Flask主应用
├── translation_engine.py  # 翻译引擎
├── templates/
│   └── index.html        # 前端界面
├── uploads/              # 上传文件目录
├── requirements.txt      # 项目依赖
└── README.md            # 项目说明
```

## 注意事项

1. **API限制**: 百度翻译免费版有QPS限制，建议分批处理大文件
2. **文件大小**: 支持最大16MB的Excel文件
3. **网络要求**: 需要稳定的网络连接访问百度翻译API
4. **浏览器兼容**: 建议使用现代浏览器（Chrome、Firefox、Safari等）

## 错误处理

- **54003错误**: 访问频率受限，系统会自动等待重试
- **52003错误**: API配置错误，请检查App ID和App Key
- **文件错误**: 确保上传的是有效的Excel文件
- **网络错误**: 检查网络连接和API服务状态

## 技术栈

- **后端**: Flask (Python)
- **前端**: HTML5 + CSS3 + JavaScript
- **Excel处理**: openpyxl
- **翻译API**: 百度翻译开放平台
- **样式**: 自定义CSS，清新渐变主题

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！ 